## Instalando e configurando o NGINX (Proxy Reverso)

- Proxy reverso: as requisições vão chegar no endereço (ip do servidor), o NGINX vai receber isso na porta definida (80 ou 443, HTTP ou HTTPS) e aí o NGINX vai passar essa requisição para nosso servidor na porta 3000 para "falar" com o Node. Com isso, o Node responde e o NGINX volta para o cliente;
    - No meio do caminho vamos ter um servidor, e isso é chamado de "proxy reverso".
- Acessar o servidor com SSH;
- Instalar o NGINX;
    - `sudo apt install nginx`;
    - Verificar se o NGINX já foi iniciado: `sudo systemctl status nginx`;
    - Se ele já estiver ativo, já deve haver uma página de boas vindas do NGINX acessando o IP do servidor.
- Vamos configurar o servidor com HTTP, para caso não tiver domínio e quiser rodar no IP do servidor, e vamos configurar o servidor com HTTPS, para caso tiver domínio;
- A configuração do servidor NGINX para HTTP está disponível em "arquivos-de-ajuda/nginx-HTTP.txt";
    - Se estiver usando domínio, deve-se incluir o domínio nesse arquivo;
    - Se estiver usando o IP, deve-se incluir o IP nesse arquivo;
    - Importante, também, trocar a porta, se for necessário (se houver outros projetos no mesmo servidor).
- Para configurar o servidor com HTTP;
    - Copiar o conteúdo do arquivo "nginx-HTTP.txt" com as devidas modificações feitas;
    - Ir no servidor e executar: `sudo nano /etc/nginx/sites-enabled/[nome do domínio ou qualquer coisa]`;
    - Salvar e sair;
    - Ir na pasta "sites-enabled": `cd /etc/nginx/sites-enabled`;
    - Apagar a pasta "default": `sudo rm default`;
    - Para confirmar que tudo está funcionando: `sudo nginx -t`;
    - Reiniciar o nginx: `sudo systemctl restart nginx`.
        - Mesma coisa que `sudo service restart nginx`.
- Para configurar o servidor com HTTPS;
    - No arquivo "letsencrypt" da pasta "arquivos-de-ajuda" tem os comandos para essa parte;
        - Executar um por um.
    - **Para isso funcionar, é preciso ter um domínio**;
    - No quarto comando, subsituir pelo domínio que se tem: `sudo certbot certonly --standalone -d [meu domínio]`.
        - Se precisar renovar o certificado, vai pedir isso após a execução do comando.
    - Após todos os comandos do arquivo "letsencrypt.txt", ir no arquivo "nginx-HTTPS.txt" e substituir os domínios lá pelo próprio domínio.
        - Mudar a porta nesse arquivo também, se trocar ela.
    - Copiar o conteúdo do arquivo "nginx-HTTPS.txt" para o arquivo do domínio em "etc/nginx/sites-enabled";
    - Reiniciar o nginx: `sudo systemctl restart nginx`.
- Com isso, tem-se as portas 80 e 443 funcionando, com HTTPS e conexão segura.
- Para renovar o certificado: `sudo certbot renew`;
- Com isso, já temos um servidor funcional.